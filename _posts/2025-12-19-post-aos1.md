---
title: "모바일(AOS)진단 1 - 안드로이드 이론"
categories:
  - 모바일(AOS)
tags:
  - 모바일(AOS)
---


>   **모바일 진단에 앞선 이론**

**Mobile App Hacking   ↔   Mobile Hacking(모바일 단말기를 해킹, 즉 OS를 해킹)**<br>
→ 모바일 진단은 모바일에서 실행하는 앱의 취약점을 찾아 악용하는 것으로, 단말기를 해킹하는 Mobile Hacking과는 다른 개념.<br>
<br>
<br>
**Mobile App Hacking 개요** <br>
모바일 앱 / 모바일 앱 서버(API서버) → 취약점을 두 관점 모두생각 <br>
 ㄴ 모바일 앱 공격 : 모바일 앱의 흐름(로직)을 조작해서 악용 / 루팅,탈옥 환경에서 앱 동작 우회 가능<br>
<br>
 ㄴ 모바일 앱 서버 공격(앱 유형별)<br>
   		Web App : 웹 사이트를 그대로 모바일에 이식한 상태, 실체는 웹 애플리케이션, 통신:HTTP/HTTPS<br>
		Hybrid App : 웹 UI + 웹 기반 데이터 처리, 통신: HTTP/HTTPS<br>
		Native App : 순수 안드로이드/IOS앱, 통신: HTTP/HTTPS, 커스텀 TCP소켓 통신(앱 리버싱을 통해 내부함수 및 통신 로직 분석)<br>
<br>

>    **안드로이드 앱 설치 및 실행 구조**

Dalvik VM   ↔   ART<br>
ㄴ Dalvik VM : classes.dex 그래로 저장하여 설치, 앱 실행시에 Dalvik VM이 그때그때 해석하여 실행<br>
 <br>
ㄴ ART(Android Runtime) : AOT(Ahead-Of-Time Compilation) 방식을 사용해 앱을 설치, 즉 앱 설치 시점에 classes.dex를 네이티브 코드(cpu가 바로 실행시키는 코드)로 변환시켜서 앱 실행시에는 CPU에서 바로 실행. <br>

**정리하면 안드로이드 앱은 APK 설치 시 classes.dex를 추출한 뒤, ART가 이를 AOT 컴파일하여 네이티브 코드로 변환하고, 앱 실행 시 CPU에서 직접 실행한다** <br>
**또한 JVM은 무겁고 라이선스 문제가 존재하여 안드로이드앱의 Dex파일을 실행하는 Dalvic VM이 출현하게되었고, 추후 Native중심 실행 구조 필요로 ART로 발전**
<br>
<br>

> **Android APK구조**<br>

Application<br>
	ㄴassets : 앱실행에 필요한 자원(동영상 같은 큰파일) 관리 폴더<br>
	ㄴres: 앱 실행에 필요한 자원(아이콘 같은 작은 파일등) 관리 폴더<br>
	ㄴMETA-INF : 인증 서명(Sign)과 관련한 정보가 담겨있는 폴더<br>
	ㄴlibs : 라이브러리 파일(*.so)이 들어있는 폴더<br>
	ㄴAndroidManifest.xml : Android정의 파일로 Android App정보(접근권한, 버전)가 들어있는 폴더<br>
	ㄴresources.acsc : 파일 리소스의 배열 / res정보 들어있는 파일<br>
	ㄴclass.dex : android 가상머신 달빅(dalvik)이 인식할 수 있도록 *.class파일을 바이트 코드로 변환시킨 소스파일<br>
<br>

**AndroidManifest.xml 상세 정보** <br>
ㄴ패키지명 : 앱 이름X(사용자에게 표시되는 이름) / 패키지명은 안드로이드 시스템 내에서 고유하게 식벽되는 것 (package 속성에 명시)<br>
<img src="/assets/images/icon/패키지명.png" style="max-width:100% border:1px solid #000; padding:4px;"><br><br>
ㄴ권한 : 앱에서 필요한 권한은 uses-permission 요소 사용하여 명시, 사용자에게 허용 요청하여 승인하면 기능 사용<br>
<img src="/assets/images/icon/uses-permission.png" style="max-width:100% border:1px solid #000; padding:4px;"><br><br>
ㄴ액티비티(Activity) : 앱에서 사용자가 단일 작업으로 처리할 수 있는 단위 (사용자와 상호작용(클릭,드래그등)을 하여 UI제공하는 화면으로 하나의 클래스)<br>
 Ex. activity android:name=".MainActivity" 경우, Mainactivity라는 이름의 클래스를 액티비티로 사용하겠다는 것 <br>
<img src="/assets/images/icon/activity.png" style="max-width:100% border:1px solid #000; padding:4px;"><br><br>
액티비티의 생명주기에 대해서.. 액티비티 간에 데이터 전달, 인텐트 호출 등의 흐름을 분석하기 위해서 알 필요있음<br>
<img src="/assets/images/icon/lifrcycle.png" style="max-width:100% border:1px solid #000; padding:4px;"><br><br>









		Activithy생명주기(Life Cycle) : onCreate() ->onStart() ->onResume() ->보여지는 상태 ->다른 액티비티가 보여짐->onPause() ->(액티비티가 완전히 보이지 않음)onStop()
ㄴ권한 정의
ㄴ외부 라이브러리 정보
